# 日志收集与分析

**问题域**

- 日志分布式追踪
- 业务/系统告警
- 日志分析
- 日志查询
- 日志收集

**约束**

- 日志输出性能影响 尽量控制在 25%左右(主要取决于整个业务链日志输出量级)
- 日志查询应该在30s内返回结果
- 告警规则支持自定义,支持分组,分级等特性
- 监控应提供全局数据可视化展示
- 日志数据存储默认为一周,应特别留意集群数据量与集群算力的比例
- 作为基础设施/应用开发/业务监控分析的重要的可靠的信息源
- 日志字段分隔符支持自定义,Debug模式应该检查非法字符输出比如字段分隔符



**业务日志格式**

- traceid   一级信息
- pspanid  一级信息
- spanid     一级信息
- 时间          一级信息
- 主机名      一级信息
- 服务名       一级信息
- 日志等级   一级信息
- 响应码       一级信息
- 信息类型   一级信息 枚举类型: request/response/body
- 日志主体信息     二级信息



日志收集

丁丁



**日志分析**

- 动态生成分布式日志链
- 支持日志展开浏览模式
- 以traceid为单位定期分析日志数据,生成时序数据存入时序数据库
- 告警系统





扩展话题:

K8S集群日志/中间件/数据库/硬件监控    日志 收集/分析/告警





监控体系的建立

(跑题话题)

从业务监控入手,到应用程序监控,到K8S集群健康度监控到硬件层监控,都应用有效的监控起来,才能为故障诊断提供足够的信息源